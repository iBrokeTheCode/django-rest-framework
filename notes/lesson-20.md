# Django REST Framework ViewSets & Routers

## 1. Key Concepts

- **ViewSets** are a type of class-based view in Django REST Framework that combine the logic for multiple related views into a single class. Unlike traditional class-based views with method handlers like `get` and `post`, ViewSets provide **actions** such as `list` and `create`. You might be familiar with similar concepts like "resources" or "controllers" in other frameworks.
- There are different types of ViewSets available in Django REST Framework, including `GenericViewSet`, `ModelViewSet`, and `BaseViewSet`. The lesson focuses on **`ModelViewSet`**, which provides default implementations for common CRUD (Create, Retrieve, Update, Destroy) operations on a given model or queryset.
- A key advantage of using ViewSets is that **repeated logic can be combined into a single class**. For example, you only need to specify the `queryset` once, and it will be used across multiple views.
- Another significant advantage is that **Routers in Django REST Framework automate the process of wiring up URL configurations** for your ViewSets. This eliminates the need to manually define individual URLs for each action in your ViewSet.
- The lesson introduces the **`DefaultRouter`** from `rest_framework.routers`. You instantiate a router and then register your ViewSet with a URL prefix. The router then automatically generates the necessary URL patterns based on the actions provided by the ViewSet.
- When registering a ViewSet with a router using `router.register('prefix', ViewSet)`, the router generates a set of standard CRUD URLs. For a prefix like `'orders'` and an `OrderViewSet`, it will typically create URLs like `/orders/` (for listing and creating) and `/orders/{pk}/` (for retrieving, updating, and deleting a specific order).
- The **`ModelViewSet` provides default actions** such as `list` (to get a list of objects), `retrieve` (to get an individual object by primary key), `create` (to create a new object), `update` (to fully update an object via PUT request), `partial_update` (to partially update an object via PATCH request), and `destroy` (to delete an object via DELETE request).
- Attributes commonly used in generic views, such as `queryset`, `serializer_class`, and `permission_classes`, also work with ViewSets because `ModelViewSet` extends the `GenericAPIView`.

## 2. Resources

- [Django REST Framework Viewsets](https://www.django-rest-framework.org/api-guide/viewsets/)
- [Classy DRF](https://www.cdrf.co/)
- [Django REST Framework Routers](https://www.django-rest-framework.org/api-guide/routers/)

## 3. Practical Steps

1.  **Import the `viewsets` module** from `rest_framework`.

    ```python
    from rest_framework import viewsets
    ```

2.  **Create a ViewSet class** that inherits from `viewsets.ModelViewSet`. This provides the default CRUD actions.

    ```python
    # views.py
    class OrderViewSet(viewsets.ModelViewSet):
        queryset = Order.objects.all()
        serializer_class = OrderSerializer
        permission_classes = [permissions.AllowAny] # Example permission
    ```

    - Here, you define the `queryset` that the ViewSet will operate on (in this case, all `Order` objects).
    - You also specify the `serializer_class` to be used for serializing and deserializing data.
    - `permission_classes` can be set to define the access control for the ViewSet.

3.  **Import the `routers` module** and the `DefaultRouter` from `rest_framework`.

    ```python
    # urls.py
    from rest_framework import routers
    ```

4.  **Instantiate the `DefaultRouter`**.

    ```python
    router = routers.DefaultRouter()
    ```

5.  **Register the ViewSet with the router** using the `register()` method. This takes a URL prefix and the ViewSet class as arguments.

    ```python
    router.register(r'orders', OrderViewSet)
    ```

    - The first argument, `'orders'`, is the **URL prefix** that will be used for the generated routes.
    - The second argument, `OrderViewSet`, is the **Viewset class** you created.
    - Note that the trailing slash in the prefix should be omitted.

6.  **Include the router's URLs in your Django project's `urlpatterns`**. You can access the generated URLs using the `router.urls` attribute.

    ```python
    # Other paths
    urlpatterns += router.urls
    ```

    - This line appends the URLs generated by the router for the `OrderViewSet` to your existing URL patterns, making the API endpoints accessible.

7.  **(Optional) Override serializer fields for specific behavior.** For example, to make a field read-only:

    ```python
    from rest_framework import serializers

    class OrderSerializer(serializers.ModelSerializer):
        order_id = serializers.UUIDField(read_only=True)

        class Meta:
            model = Order
            fields = '__all__'
    ```

    - By setting `read_only=True` for the `order_id` field, it will not be included in the request when creating or updating an order, but it will be present in the response.

8.  **(Optional) Disable pagination for a specific ViewSet.**

    ```python
    class OrderViewSet(viewsets.ModelViewSet):
        queryset = Order.objects.all()
        serializer_class = OrderSerializer
        permission_classes = [permissions.AllowAny]
        pagination_class = None
    ```

    - Setting `pagination_class = None` on the ViewSet will disable the default pagination settings for this specific ViewSet.

By following these steps, you can efficiently create a full CRUD API for your Django models using Django REST Framework's ViewSets and Routers, significantly reducing the amount of code you need to write and manage.
